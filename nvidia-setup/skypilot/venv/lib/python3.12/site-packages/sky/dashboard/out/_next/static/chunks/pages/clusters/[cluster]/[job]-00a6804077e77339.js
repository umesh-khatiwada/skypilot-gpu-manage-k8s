(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9826],{94966:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/clusters/[cluster]/[job]",function(){return t(50190)}])},27325:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});/**
 * @license lucide-react v0.407.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,t(60998).Z)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},15821:function(e,s,t){"use strict";function n(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,n=document.getElementById("toast-container");n||((n=document.createElement("div")).id="toast-container",n.className="fixed top-0 right-0 p-4 z-[9999] flex flex-col items-end space-y-2",document.body.appendChild(n));let r=document.createElement("div");switch(r.className="rounded-md border-l-4 p-4 shadow-md flex items-center justify-between max-w-md w-full mb-2 pointer-events-auto",s){case"success":r.className+=" bg-green-100 border-green-500 text-green-800";break;case"error":r.className+=" bg-red-100 border-red-500 text-red-800";break;case"warning":r.className+=" bg-yellow-100 border-yellow-500 text-yellow-800";break;default:r.className+=" bg-blue-100 border-blue-500 text-blue-800"}return r.innerHTML='\n      <div class="flex-1 mr-2">\n        <p class="text-sm font-medium">'.concat(e,'</p>\n      </div>\n      <button class="text-gray-500 hover:text-gray-700 focus:outline-none" aria-label="Close toast">\n        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n          <line x1="18" y1="6" x2="6" y2="18"></line>\n          <line x1="6" y1="6" x2="18" y2="18"></line>\n        </svg>\n      </button>\n    '),n.appendChild(r),r.querySelector("button").addEventListener("click",()=>{n.removeChild(r)}),setTimeout(()=>{n.contains(r)&&n.removeChild(r)},t),r}t.d(s,{C:function(){return n}})},50190:function(e,s,t){"use strict";t.r(s),t.d(s,{JobDetailPage:function(){return _}});var n=t(85893),r=t(67294),a=t(37673),i=t(41664),l=t.n(i),c=t(11163),o=t(23266),d=t(470),m=t(13626),x=t(16826),u=t(55739),h=t(99307),f=t(23001),j=t(9008),b=t.n(j),g=t(20546),N=t(70282),y=t(27325),v=t(45697),p=t.n(v),w=t(21494);function k(e){let{cluster:s,job:t,jobData:r,onRefresh:a,isRefreshing:i,loading:c}=e,o=(0,f.X)();return(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4 h-5",children:[(0,n.jsxs)("div",{className:"text-base flex items-center",children:[(0,n.jsx)(l(),{href:"/clusters",className:"text-sky-blue hover:underline",children:"Sky Clusters"}),(0,n.jsx)("span",{className:"mx-2 text-gray-500",children:"›"}),(0,n.jsx)(l(),{href:"/clusters/".concat(s),className:"text-sky-blue hover:underline",children:s}),(0,n.jsx)("span",{className:"mx-2 text-gray-500",children:"›"}),(0,n.jsxs)(l(),{href:"/clusters/".concat(s,"/").concat(t),className:"text-sky-blue hover:underline",children:[t,r.job&&"-"!=r.job?" (".concat(r.job,")"):""]})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(c||i)&&(0,n.jsxs)("div",{className:"flex items-center mr-2",children:[(0,n.jsx)(u.Z,{size:15,className:"mt-0"}),(0,n.jsx)("span",{className:"text-sm ml-2 text-gray-500",children:"Loading..."})]}),(0,n.jsx)(d.WH,{content:"Refresh",className:"text-muted-foreground",children:(0,n.jsxs)("button",{onClick:a,disabled:c||i,className:"text-sm text-sky-blue hover:text-sky-blue-bright font-medium mx-2 flex items-center",children:[(0,n.jsx)(m.Z,{className:"w-4 h-4 mr-1.5"}),!o&&(0,n.jsx)("span",{children:"Refresh"})]})})]})]})}function _(){let e=(0,c.useRouter)(),{cluster:s,job:t}=e.query,{clusterData:i,clusterJobData:f,loading:j,refreshData:v}=(0,o.QL)({cluster:s}),[p,_]=(0,r.useState)(!1),[C,D]=(0,r.useState)(!0),[E,T]=(0,r.useState)(!1),[S,Z]=(0,r.useState)(0),P=(0,r.useMemo)(()=>["INIT","PENDING","SETTING_UP"],[]),R=(0,r.useMemo)(()=>{if(!f||!t)return!0;let e=f.find(e=>e.id==t);return e&&P.includes(e.status)},[f,t,P]);(0,r.useEffect)(()=>{!j&&C&&D(!1)},[j,C]);let L=(0,r.useMemo)(()=>({clusterName:s,jobId:t,workspace:null==i?void 0:i.workspace}),[s,t,null==i?void 0:i.workspace]),H=(0,r.useCallback)(e=>{console.error("Error streaming cluster logs:",e)},[]),{lines:I,isLoading:O}=(0,w.V)({streamFn:o.Sl,streamArgs:L,enabled:!!(s&&t)&&!R,refreshTrigger:S,onError:H}),A=async()=>{_(!0),Z(e=>e+1);try{v&&await v()}catch(e){console.error("Error refreshing data:",e)}finally{_(!1)}};if(!e.isReady)return(0,n.jsx)("div",{children:"Loading..."});let M={id:t};if(i&&f){let e=f.find(e=>e.id==t);e&&(M={...e,infra:i.infra,cluster:i.cluster,user:i.user,user_hash:i.user_hash})}let z=s&&t?"Job: ".concat(t," @ ").concat(s," | SkyPilot Dashboard"):"Job Details | SkyPilot Dashboard";return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(b(),{children:(0,n.jsx)("title",{children:z})}),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(k,{cluster:s,job:t,jobData:M,onRefresh:A,isRefreshing:p,loading:j}),j&&C?(0,n.jsxs)("div",{className:"flex items-center justify-center h-64",children:[(0,n.jsx)(u.Z,{size:24,className:"mr-2"}),(0,n.jsx)("span",{children:"Loading..."})]}):(0,n.jsxs)("div",{className:"space-y-8",children:[(0,n.jsx)("div",{id:"details",children:(0,n.jsxs)(a.Zb,{children:[(0,n.jsx)("div",{className:"flex items-center justify-between px-4 pt-4",children:(0,n.jsx)("h2",{className:"text-lg font-semibold",children:"Details"})}),(0,n.jsx)("div",{className:"p-4",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-gray-600 font-medium text-base",children:"Job ID"}),(0,n.jsx)("div",{className:"text-base mt-1",children:M.id})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-gray-600 font-medium text-base",children:"Job Name"}),(0,n.jsx)("div",{className:"text-base mt-1",children:M.job})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-gray-600 font-medium text-base",children:"Status"}),(0,n.jsx)("div",{className:"text-base mt-1",children:(0,n.jsx)(h.OE,{status:M.status})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-gray-600 font-medium text-base",children:"User"}),(0,n.jsx)("div",{className:"text-base mt-1",children:(0,n.jsx)(g.H,{username:M.user,userHash:M.user_hash})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-gray-600 font-medium text-base",children:"Submitted"}),(0,n.jsx)("div",{className:"text-base mt-1",children:M.submitted_at?(0,d.xn)(M.submitted_at):"N/A"})]}),M.resources&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-gray-600 font-medium text-base",children:"Requested Resources"}),(0,n.jsx)("div",{className:"text-base mt-1",children:M.resources||"N/A"})]}),M.cluster&&(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-gray-600 font-medium text-base",children:"Cluster"}),(0,n.jsx)("div",{className:"text-base mt-1",children:(0,n.jsx)(l(),{href:"/clusters/".concat(M.cluster),className:"text-sky-blue hover:underline",children:M.cluster})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-gray-600 font-medium text-base",children:"Git Commit"}),(0,n.jsx)("div",{className:"text-base mt-1 flex items-center",children:M.git_commit&&"-"!==M.git_commit?(0,n.jsxs)("span",{className:"flex items-center mr-2",children:[M.git_commit,(0,n.jsx)(d.WH,{content:E?"Copied!":"Copy commit",className:"text-muted-foreground",children:(0,n.jsx)("button",{onClick:async()=>{await navigator.clipboard.writeText(M.git_commit),T(!0),setTimeout(()=>T(!1),2e3)},className:"flex items-center text-gray-500 hover:text-gray-700 transition-colors duration-200 p-1 ml-2",children:E?(0,n.jsx)(N.Z,{className:"w-4 h-4 text-green-600"}):(0,n.jsx)(y.Z,{className:"w-4 h-4"})})})]}):(0,n.jsx)("span",{className:"text-gray-400",children:"-"})})]})]})})]})}),(0,n.jsx)("div",{id:"logs",className:"mt-6",children:(0,n.jsxs)(a.Zb,{children:[(0,n.jsxs)("div",{className:"flex items-center justify-between px-4 pt-4",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold",children:"Logs"}),(0,n.jsx)("span",{className:"ml-2 text-xs text-gray-500",children:"(Logs are not streaming; click refresh to fetch the latest logs.)"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)(d.WH,{content:"Download full logs",className:"text-muted-foreground",children:(0,n.jsx)("button",{onClick:()=>(0,o.GH)({clusterName:s,jobIds:t?[t]:null,workspace:null==i?void 0:i.workspace}),className:"text-sky-blue hover:text-sky-blue-bright flex items-center",children:(0,n.jsx)(x.Z,{className:"w-4 h-4"})})}),(0,n.jsx)(d.WH,{content:"Refresh logs",className:"text-muted-foreground",children:(0,n.jsx)("button",{onClick:()=>{Z(e=>e+1)},disabled:O,className:"text-sky-blue hover:text-sky-blue-bright flex items-center",children:(0,n.jsx)(m.Z,{className:"w-4 h-4 ".concat(O?"animate-spin":"")})})})]})]}),(0,n.jsx)("div",{className:"p-4",children:R?(0,n.jsx)("div",{className:"bg-[#f7f7f7] flex items-center justify-center py-4 text-gray-500",children:(0,n.jsx)("span",{children:"Waiting for the job to start; refresh in a few moments."})}):O?(0,n.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,n.jsx)(u.Z,{size:20,className:"mr-2"}),(0,n.jsx)("span",{children:"Loading..."})]}):(0,n.jsx)("div",{className:"max-h-96 overflow-y-auto",children:(0,n.jsx)(d.$B,{logs:I})})})]})})]})]})]})}k.propTypes={cluster:p().oneOfType([p().string,p().number]),job:p().oneOfType([p().string,p().number]),jobData:p().shape({job:p().oneOfType([p().string,p().number])}),onRefresh:p().func,isRefreshing:p().bool,loading:p().bool},s.default=_},10410:function(e,s,t){"use strict";t.d(s,{M:function(){return a}});var n=t(23800),r=t(6378);async function a(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=(0,n.A_)(s);if(0===a.length)return e;let i={dashboardCache:t.dashboardCache||r.ZP,getOriginalData:()=>Promise.resolve(e),rawData:t.rawData||null,...t},l=e;for(let e of a){let s=l;try{let t=await e.enhance(s,i);if(!Array.isArray(t)){console.error("[Plugin] Data enhancement ".concat(e.id," did not return an array. Skipping."));continue}t.length!==s.length&&console.warn("[Plugin] Data enhancement ".concat(e.id," changed array length from ").concat(s.length," to ").concat(t.length,". This is not recommended.")),l=t}catch(s){console.error("[Plugin] Data enhancement ".concat(e.id," failed:"),s)}}return l}}},function(e){e.O(0,[5739,3850,1676,6612,2888,9774,179],function(){return e(e.s=94966)}),_N_E=e.O()}]);