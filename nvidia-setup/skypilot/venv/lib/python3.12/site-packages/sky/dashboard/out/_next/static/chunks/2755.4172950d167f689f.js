"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2755],{27325:function(e,t,s){s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.407.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(60998).Z)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},81260:function(e,t,s){s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.407.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(60998).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},47603:function(e,t,s){s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.407.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(60998).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},1812:function(e,t,s){s.d(t,{X:function(){return l}});var r=s(85893),n=s(67294);let a=e=>{if(!(null==e?void 0:e.message))return"An unexpected error occurred.";let t=e.message;return t.includes("failed:")&&(t=t.split("failed:")[1].trim()),t},l=e=>{let{error:t,title:s="Error",onDismiss:l}=e,[o,i]=(0,n.useState)(!1);if((0,n.useEffect)(()=>{t&&i(!1)},[t]),!t||o)return null;let c="string"==typeof t?t:a(t);return(0,r.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-md p-3 mb-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsxs)("div",{className:"text-sm text-red-800",children:[(0,r.jsxs)("strong",{children:[s,":"]})," ",c]})})]}),(0,r.jsx)("button",{onClick:()=>{i(!0),l&&l()},className:"flex-shrink-0 ml-4 text-red-400 hover:text-red-600 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 focus:ring-offset-red-50 rounded","aria-label":"Dismiss error",children:(0,r.jsx)("svg",{className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})})}},27669:function(e,t,s){s.r(t),s.d(t,{Users:function(){return H}});var r=s(85893),n=s(67294),a=s(45697),l=s.n(a),o=s(55739),i=s(41664),c=s.n(i),u=s(11163),d=s(30803),m=s(68764),x=s(53081),h=s(23266),p=s(68969),g=s(6378),f=s(36856),b=s(51214),j=s(94545),y=s(470),v=s(60998);/**
 * @license lucide-react v0.407.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let w=(0,v.Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var N=s(13626),k=s(81260);/**
 * @license lucide-react v0.407.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let C=(0,v.Z)("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),_=(0,v.Z)("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);var S=s(16826),E=s(70282),R=s(43767);/**
 * @license lucide-react v0.407.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let D=(0,v.Z)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),I=(0,v.Z)("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);var T=s(47603),L=s(27325);s(9353);var Z=s(23001),P=s(66235),U=s(37673),A=s(47145),F=s(50326),M=s(1812),O=s(9243),z=s(10546);let V=new Set(O.statusGroups.active),q=[{label:"Name",value:"name"},{label:"GPU",value:"gpu type"},{label:"Infra",value:"infra"},{label:"User ID",value:"user id"},{label:"Role",value:"role"}],B=(e,t)=>{if(!e)return 0;let s=e;if("string"==typeof e)try{let t=e.replace(/'/g,'"').replace(/None/g,"null");s=JSON.parse(t)}catch(t){return console.error("Failed to parse accelerators string:",e,t),0}if("object"==typeof s&&null!==s){let e=Object.entries(s);return 0===e.length?0:(e.length>1&&console.warn("".concat(t," has ").concat(e.length," accelerator entries:"),s),Number(e[0][1])||0)}return 0},K=(e,t)=>e&&e.includes("@")?e.split("@")[0]:e||"N/A",G=(e,t)=>e&&e.includes("@")?e:t||"-",J=b.nb.REFRESH_INTERVAL,$=e=>{let{message:t,onDismiss:s}=e;return t?(0,r.jsx)("div",{className:"bg-green-50 border border-green-200 rounded p-4 mb-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)("p",{className:"text-sm font-medium text-green-800",children:t})})]}),s&&(0,r.jsx)("div",{className:"ml-auto pl-3",children:(0,r.jsx)("div",{className:"-mx-1.5 -my-1.5",children:(0,r.jsxs)("button",{type:"button",onClick:s,className:"inline-flex rounded-md bg-green-50 p-1.5 text-green-500 hover:bg-green-100 focus:outline-none focus:ring-2 focus:ring-green-600 focus:ring-offset-2 focus:ring-offset-green-50",children:[(0,r.jsx)("span",{className:"sr-only",children:"Dismiss"}),(0,r.jsx)("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})]})})})]})}):null};function H(){let e=(0,u.useRouter)(),{userEmail:t}=(0,P.Ap)(),[s,a]=(0,n.useState)(!1),l=(0,n.useRef)(null),i=(0,Z.X)(),[c,m]=(0,n.useState)(!1),[f,b]=(0,n.useState)({username:"",password:"",role:"user"}),[j,v]=(0,n.useState)(!1),[E,R]=(0,n.useState)({open:!1,message:"",userName:""}),[D,I]=(0,n.useState)(null),[T,L]=(0,n.useState)(!1),[U,O]=(0,n.useState)(!1),[V,B]=(0,n.useState)(!1),[K,G]=(0,n.useState)(null),[H,Q]=(0,n.useState)(!1),[Y,ee]=(0,n.useState)(null),[et,es]=(0,n.useState)("import"),[er,en]=(0,n.useState)(!1),[ea,el]=(0,n.useState)(null),[eo,ei]=(0,n.useState)(""),[ec,eu]=(0,n.useState)(!1),[ed,em]=(0,n.useState)(null),[ex,eh]=(0,n.useState)(!1),[ep,eg]=(0,n.useState)(null),[ef,eb]=(0,n.useState)(null),[ej,ey]=(0,n.useState)(!1),[ev,ew]=(0,n.useState)(null),[eN,ek]=(0,n.useState)(null),[eC,e_]=(0,n.useState)(void 0),[eS,eE]=(0,n.useState)(void 0),[eR,eD]=(0,n.useState)(void 0),[eI,eT]=(0,n.useState)(!0),[eL,eZ]=(0,n.useState)("users"),[eP,eU]=(0,n.useState)(!1),[eA,eF]=(0,n.useState)(!1),[eM,eO]=(0,n.useState)(null),[ez,eV]=(0,n.useState)(!1),[eq,eB]=(0,n.useState)(""),[eK,eG]=(0,n.useState)(""),[eJ,e$]=(0,n.useState)([]),[eH,eW]=(0,n.useState)({name:[],"user id":[],role:[],"gpu type":[],infra:[]}),[eX,eQ]=(0,n.useState)(null),[eY,e0]=(0,n.useState)(()=>{if(e.isReady){let t=e.query.deduplicate;if(void 0!==t)return"true"===t}return!0});(0,n.useEffect)(()=>{if(e.isReady){let s=e.query.deduplicate;if(void 0===s)e1(!t);else{let e="true"===s;eY!==e&&e0(e)}}},[e.isReady,e.query.deduplicate,t]);let e1=t=>{let s={...e.query};s.deduplicate=t.toString(),e.replace({pathname:e.pathname,query:s},void 0,{shallow:!0})},e2=t=>{(0,z.eG)(e,t)},e4=new Map([["name","Name"],["user id","User ID"],["role","Role"],["gpu type","GPU"],["infra","Infra"]]);(0,n.useEffect)(()=>{if(e.isReady&&"users"===eL){let t=(0,z.Fu)(e,e4);t.length>0&&e$(t)}},[e.isReady,eL]),(0,n.useEffect)(()=>{e.isReady&&("service-accounts"===e.query.tab&&eS?eZ("service-accounts"):eZ("users"))},[e.isReady,e.query.tab,eS]),(0,n.useEffect)(()=>{(async function(){eT(!0);try{let e=await A.x.get("/api/health");if(e.ok){let t=await e.json();e_(!!t.basic_auth_enabled),eE(!!t.service_account_token_enabled),eD(!!t.ingress_basic_auth_enabled)}else e_(!1),eE(!1),eD(!1)}catch(e){e_(!1),eE(!1),eD(!1)}finally{eT(!1)}})()},[]);let e3=(0,n.useCallback)(async()=>{if(D&&Date.now()-D.timestamp<3e5)return D;L(!0);try{let e=await A.x.get("/users/role");if(!e.ok){let t=await e.json();throw Error(t.detail||"Failed to get user role")}let t=await e.json(),s={role:t.role,name:t.name,id:t.id,timestamp:Date.now()};return I(s),L(!1),s}catch(e){throw L(!1),e}},[D]);(0,n.useEffect)(()=>{e3().catch(()=>{console.error("Failed to get user role")})},[e3]);let e5=async(e,t)=>{try{let s=await e3();if("admin"!==s.role)return R({open:!0,message:e,userName:s.name.toLowerCase()}),!1;return t(),!0}catch(e){return console.error("Failed to check user role:",e),R({open:!0,message:"Error: ".concat(e.message),userName:""}),!1}},e6=()=>{g.ZP.invalidate(x.R),g.ZP.invalidate(h.getClusters),g.ZP.invalidate(p.getManagedJobs,[{allUsers:!0,skipFinished:!0}]),l.current&&l.current()};(0,n.useEffect)(()=>{let e=e=>{(e.metaKey||e.ctrlKey)&&"r"===e.key&&(e.preventDefault(),e.stopPropagation(),e6())};return document.addEventListener("keydown",e,!0),()=>{document.removeEventListener("keydown",e,!0)}},[]);let e7=async()=>{if(!f.username||!f.password){ek(Error("Username and password are required.")),m(!1);return}v(!0),ek(null),ew(null);try{let e=await A.x.post("/users/create",f);if(!e.ok){let t=await e.json();throw Error(t.detail||"Failed to create user")}ew('User "'.concat(f.username,'" created successfully!')),m(!1),b({username:"",password:"",role:"user"}),e6()}catch(e){ek(e),m(!1),b({username:"",password:"",role:"user"})}finally{v(!1)}},e8=async e=>{let t=e.target.files[0];t&&(G(t),ee(null))},e9=async()=>{if(!K){alert("Please select a CSV file first.");return}Q(!0);try{let e=new FileReader;e.onload=async e=>{try{let t=e.target.result,s=await A.x.post("/users/import",{csv_content:t});if(!s.ok){let e=await s.json();throw Error(e.detail||"Failed to import users")}let r=await s.json(),n="Import completed. ".concat(r.success_count," users created successfully.");r.error_count>0&&(n+="\n".concat(r.error_count," failed."),r.creation_errors.length>0&&(n+="\nErrors: ".concat(r.creation_errors.slice(0,3).join(", ")),r.creation_errors.length>3&&(n+=" and ".concat(r.creation_errors.length-3," more...")))),ee({message:n}),r.success_count>0&&e6()}catch(e){alert("Error importing users: ".concat(e.message))}finally{Q(!1)}},e.readAsText(K)}catch(e){alert("Error reading file: ".concat(e.message)),Q(!1)}},te=async e=>{el(e),ei(""),en(!0)},tt=async()=>{if(!eo){ek(Error("Please enter a new password."));return}eu(!0),em(null);try{let e=await A.x.post("/users/update",{user_id:ea.userId,password:eo});if(!e.ok){let t=await e.json();throw Error(t.detail||"Failed to reset password")}ew('Password reset successfully for user "'.concat(ea.usernameDisplay,'"!')),en(!1),el(null),ei("")}catch(e){en(!1),el(null),ei(""),em(null),ek(e)}finally{eu(!1)}},ts=async()=>{if(ep){ey(!0),eb(null);try{let e=await A.x.post("/users/delete",{user_id:ep.userId});if(!e.ok){let t=await e.json();throw Error(t.detail||"Failed to delete user")}ew('User "'.concat(ep.usernameDisplay,'" deleted successfully!')),eh(!1),eg(null),e6()}catch(e){eh(!1),eg(null),eb(null),ek(e)}finally{ey(!1)}}},tr=()=>{eh(!1),eg(null)},tn=()=>{en(!1),el(null),ei("")};return eI?(0,r.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,r.jsx)(o.Z,{}),(0,r.jsx)("span",{className:"ml-2 text-gray-500",children:"Loading..."})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"text-base flex items-center",children:[(0,r.jsx)("button",{className:eS?"leading-none mr-6 pb-2 px-2 border-b-2 ".concat("users"===eL?"text-sky-blue border-sky-500":"text-gray-500 hover:text-gray-700 border-transparent"):"leading-none mr-6 pb-2 px-2",onClick:()=>{eZ("users"),e.push("/users",void 0,{shallow:!0})},children:"Users"}),eS&&(0,r.jsx)("button",{className:"leading-none pb-2 px-2 border-b-2 ".concat("service-accounts"===eL?"text-sky-blue border-sky-500":"text-gray-500 hover:text-gray-700 border-transparent"),onClick:()=>{eZ("service-accounts"),e.push("/users?tab=service-accounts",void 0,{shallow:!0})},children:"Service Accounts"})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[s&&(0,r.jsxs)("div",{className:"flex items-center mr-2",children:[(0,r.jsx)(o.Z,{size:15,className:"mt-0"}),(0,r.jsx)("span",{className:"ml-2 text-gray-500",children:"Loading..."})]}),"users"===eL&&eC&&(null==D?void 0:D.role)==="admin"&&(0,r.jsx)("button",{onClick:async()=>{await e5("cannot create users",()=>{m(!0)})},className:"text-sky-blue hover:text-sky-blue-bright flex items-center rounded px-2 py-1 mr-2",title:"Create New User",children:"+ New User"}),"users"===eL&&eC&&(null==D?void 0:D.role)==="admin"&&(0,r.jsxs)("button",{onClick:async()=>{await e5("cannot import users",()=>{B(!0)})},className:"text-sky-blue hover:text-sky-blue-bright flex items-center rounded px-2 py-1 mr-2",title:"Import/Export Users",children:[(0,r.jsx)(w,{className:"h-4 w-4 mr-1"}),"Import/Export"]}),!s&&eX&&(0,r.jsx)(y.$3,{timestamp:eX,className:"mr-2"}),(0,r.jsxs)("button",{onClick:e6,disabled:s,className:"text-sky-blue hover:text-sky-blue-bright flex items-center",children:[(0,r.jsx)(N.Z,{className:"h-4 w-4 mr-1.5"}),!i&&(0,r.jsx)("span",{children:"Refresh"})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:["users"===eL?(0,r.jsx)("div",{className:"w-full sm:w-auto max-w-md",children:(0,r.jsx)(z.ML,{propertyList:q,valueList:eH,setFilters:e$,updateURLParams:e2,placeholder:"Filter users"})}):(0,r.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,r.jsx)("input",{type:"text",placeholder:"Search by service account name, or created by",value:eK,onChange:e=>{eG(e.target.value)},className:"h-8 w-full px-3 pr-8 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-sky-500 focus:border-sky-500 outline-none"}),eK&&(0,r.jsx)("button",{onClick:()=>{eG("")},className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",title:"Clear search",children:(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),"users"===eL&&!t&&(0,r.jsxs)("label",{className:"flex items-center cursor-pointer ml-4",children:[(0,r.jsx)("input",{type:"checkbox",checked:eY,onChange:e=>{let t=e.target.checked;e0(t),e1(t)},className:"sr-only"}),(0,r.jsx)("div",{className:"relative inline-flex h-5 w-9 items-center rounded-full transition-colors ".concat(eY?"bg-sky-600":"bg-gray-300"),children:(0,r.jsx)("span",{className:"inline-block h-3 w-3 transform rounded-full bg-white transition-transform ".concat(eY?"translate-x-5":"translate-x-1")})}),(0,r.jsx)("span",{className:"ml-2 text-sm text-gray-700",children:"Deduplicate users"})]}),"service-accounts"===eL&&eS&&(0,r.jsxs)("button",{onClick:()=>{e5("cannot create service account tokens",()=>{eU(!0)})},className:"ml-4 bg-sky-600 hover:bg-sky-700 text-white flex items-center rounded-md px-3 py-1 text-sm font-medium transition-colors duration-200",title:"Create Service Account",children:[(0,r.jsx)(k.Z,{className:"h-4 w-4 mr-2"}),"Create Service Account"]})]}),"users"===eL&&(0,r.jsx)(z.x$,{filters:eJ,setFilters:e$,updateURLParams:e2}),(0,r.jsxs)("div",{className:"fixed top-20 right-4 z-[9999] max-w-md",children:[(0,r.jsx)($,{message:ev,onDismiss:()=>ew(null)}),(0,r.jsx)(M.X,{error:eN,title:"Error",onDismiss:()=>ek(null)})]}),"users"===eL?(0,r.jsx)(W,{refreshInterval:J,setLoading:a,refreshDataRef:l,checkPermissionAndAct:e5,roleLoading:T,onResetPassword:te,onDeleteUser:e=>{e5("cannot delete users",()=>{eg(e),eh(!0)})},basicAuthEnabled:eC,ingressBasicAuthEnabled:eR,currentUserRole:null==D?void 0:D.role,currentUserId:null==D?void 0:D.id,filters:eJ,setValueList:eW,deduplicateUsers:eY,setLastFetchedTime:eQ}):eS&&(0,r.jsx)(X,{checkPermissionAndAct:e5,userRoleCache:D,setCreateSuccess:ew,setCreateError:ek,showCreateDialog:eP,setShowCreateDialog:eU,showRotateDialog:eA,setShowRotateDialog:eF,tokenToRotate:eM,setTokenToRotate:eO,rotating:ez,setRotating:eV,searchQuery:eK,setSearchQuery:eG}),(0,r.jsx)(F.Vq,{open:c,onOpenChange:e=>{m(e),e||ek(null)},children:(0,r.jsxs)(F.cZ,{className:"sm:max-w-md",children:[(0,r.jsx)(F.fK,{children:(0,r.jsx)(F.$N,{children:"Create User"})}),(0,r.jsxs)("div",{className:"flex flex-col gap-4 py-4",children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Username"}),(0,r.jsx)("input",{className:"border rounded px-3 py-2 w-full",placeholder:"Username",value:f.username,onChange:e=>b({...f,username:e.target.value})})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Password"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{className:"border rounded px-3 py-2 w-full pr-10",placeholder:"Password",type:U?"text":"password",value:f.password,onChange:e=>b({...f,password:e.target.value})}),(0,r.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",onClick:()=>O(!U),children:U?(0,r.jsx)(C,{className:"h-4 w-4"}):(0,r.jsx)(_,{className:"h-4 w-4"})})]})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Role"}),(0,r.jsxs)("select",{className:"border rounded px-3 py-2 w-full",value:f.role,onChange:e=>b({...f,role:e.target.value}),children:[(0,r.jsx)("option",{value:"user",children:"User"}),(0,r.jsx)("option",{value:"admin",children:"Admin"})]})]})]}),(0,r.jsxs)(F.cN,{children:[(0,r.jsx)("button",{className:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2",onClick:()=>m(!1),disabled:j,children:"Cancel"}),(0,r.jsx)("button",{className:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-sky-600 text-white hover:bg-sky-700 h-10 px-4 py-2",onClick:e7,disabled:j,children:j?"Creating...":"Create"})]})]})}),(0,r.jsx)(F.Vq,{open:E.open,onOpenChange:e=>{R(t=>({...t,open:e})),e||ek(null)},children:(0,r.jsxs)(F.cZ,{className:"sm:max-w-md transition-all duration-200 ease-in-out",children:[(0,r.jsxs)(F.fK,{children:[(0,r.jsx)(F.$N,{children:"Permission Denied"}),(0,r.jsx)(F.Be,{children:T?(0,r.jsxs)("div",{className:"flex items-center py-2",children:[(0,r.jsx)(o.Z,{size:16,className:"mr-2"}),(0,r.jsx)("span",{children:"Checking permissions..."})]}):(0,r.jsx)(r.Fragment,{children:E.userName?(0,r.jsxs)(r.Fragment,{children:[E.userName," is logged in as non-admin and ",E.message,"."]}):E.message})})]}),(0,r.jsx)(F.cN,{children:(0,r.jsx)(d.z,{variant:"outline",onClick:()=>R(e=>({...e,open:!1})),disabled:T,children:"OK"})})]})}),(0,r.jsx)(F.Vq,{open:V,onOpenChange:e=>{B(e),e||ek(null)},children:(0,r.jsxs)(F.cZ,{className:"sm:max-w-lg",children:[(0,r.jsx)(F.fK,{children:(0,r.jsx)(F.$N,{children:"Import/Export Users"})}),(0,r.jsxs)("div",{className:"flex border-b border-gray-200 mb-4",children:[(0,r.jsx)("button",{className:"px-4 py-2 text-sm font-medium ".concat("import"===et?"border-b-2 border-sky-500 text-sky-600":"text-gray-500 hover:text-gray-700"),onClick:()=>es("import"),children:"Import"}),(0,r.jsx)("button",{className:"px-4 py-2 text-sm font-medium ".concat("export"===et?"border-b-2 border-sky-500 text-sky-600":"text-gray-500 hover:text-gray-700"),onClick:()=>es("export"),children:"Export"})]}),(0,r.jsx)("div",{className:"flex flex-col gap-4 py-4",children:"import"===et?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"CSV File"}),(0,r.jsx)("input",{type:"file",accept:".csv",onChange:e8,className:"border rounded px-3 py-2 w-full"}),(0,r.jsxs)("p",{className:"text-xs text-gray-500",children:["CSV should have columns: username, password, role",(0,r.jsx)("br",{}),"Supports both plain text passwords and exported password hashes."]})]}),Y&&(0,r.jsx)("div",{className:"p-3 bg-green-50 border border-green-200 rounded text-green-700 text-sm",children:Y.message})]}):(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Export Users to CSV"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Download all users as a CSV file with password hashes."}),(0,r.jsxs)("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded",children:[(0,r.jsx)("p",{className:"text-sm text-amber-700",children:"⚠️ This will export all users with columns: username, password (hashed), role"}),(0,r.jsx)("p",{className:"text-xs text-amber-600 mt-1",children:"Password hashes can be imported directly for system backups."})]})]})})}),(0,r.jsxs)(F.cN,{children:[(0,r.jsx)("button",{className:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2",onClick:()=>B(!1),disabled:H,children:"Cancel"}),"import"===et?(0,r.jsx)("button",{className:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-sky-600 text-white hover:bg-sky-700 h-10 px-4 py-2",onClick:e9,disabled:H||!K,children:H?"Importing...":"Import"}):(0,r.jsxs)("button",{className:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-sky-600 text-white hover:bg-sky-700 h-10 px-4 py-2",onClick:async()=>{try{let e=await A.x.get("/users/export");if(!e.ok){let t=await e.json();throw Error(t.detail||"Failed to export users")}let t=await e.json(),s=t.csv_content,r=new Blob([s],{type:"text/csv;charset=utf-8;"}),n=URL.createObjectURL(r),a=document.createElement("a");a.href=n;let l=new Date,o=e=>String(e).padStart(2,"0"),i=l.getFullYear(),c=o(l.getMonth()+1),u=o(l.getDate()),d=o(l.getHours()),m=o(l.getMinutes()),x=o(l.getSeconds());a.download="users_export_".concat(i,"-").concat(c,"-").concat(u,"-").concat(d,"-").concat(m,"-").concat(x,".csv"),a.click(),URL.revokeObjectURL(n),alert("Successfully exported ".concat(t.user_count," users to CSV file."))}catch(e){alert("Error exporting users: ".concat(e.message))}},children:[(0,r.jsx)(S.Z,{className:"h-4 w-4 mr-1"}),"Export"]})]})]})}),(0,r.jsx)(F.Vq,{open:er,onOpenChange:e=>{e||(tn(),ek(null))},children:(0,r.jsxs)(F.cZ,{className:"sm:max-w-md",children:[(0,r.jsxs)(F.fK,{children:[(0,r.jsx)(F.$N,{children:"Reset Password"}),(0,r.jsxs)(F.Be,{children:["Enter a new password for"," ",(null==ea?void 0:ea.usernameDisplay)||"this user","."]})]}),(0,r.jsx)("div",{className:"flex flex-col gap-4 py-4",children:(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"New Password"}),(0,r.jsx)("input",{type:"password",className:"border rounded px-3 py-2 w-full",placeholder:"Enter new password",value:eo,onChange:e=>ei(e.target.value),autoFocus:!0})]})}),(0,r.jsxs)(F.cN,{children:[(0,r.jsx)(d.z,{variant:"outline",onClick:tn,disabled:ec,children:"Cancel"}),(0,r.jsx)(d.z,{variant:"default",onClick:tt,disabled:ec||!eo,className:"bg-sky-600 text-white hover:bg-sky-700",children:ec?"Resetting...":"Reset Password"})]})]})}),(0,r.jsx)(F.Vq,{open:ex,onOpenChange:e=>{e||(tr(),ek(null))},children:(0,r.jsxs)(F.cZ,{className:"sm:max-w-md",children:[(0,r.jsxs)(F.fK,{children:[(0,r.jsx)(F.$N,{children:"Delete User"}),(0,r.jsxs)(F.Be,{children:['Are you sure you want to delete user "',(null==ep?void 0:ep.usernameDisplay)||"this user",'"? This action cannot be undone.']})]}),(0,r.jsxs)(F.cN,{children:[(0,r.jsx)(d.z,{variant:"outline",onClick:tr,disabled:ej,children:"Cancel"}),(0,r.jsx)(d.z,{variant:"destructive",onClick:ts,disabled:ej,children:ej?"Deleting...":"Delete"})]})]})})]})}function W(e){let{refreshInterval:t,setLoading:s,refreshDataRef:a,checkPermissionAndAct:l,roleLoading:i,onResetPassword:u,onDeleteUser:d,basicAuthEnabled:b,ingressBasicAuthEnabled:v,currentUserRole:w,currentUserId:N,filters:k,setValueList:C,deduplicateUsers:_,setLastFetchedTime:S}=e,[L,Z]=(0,n.useState)([]),[P,F]=(0,n.useState)(!0),[M,O]=(0,n.useState)(!1),[q,J]=(0,n.useState)({key:"username",direction:"ascending"}),[$,H]=(0,n.useState)(null),[W,X]=(0,n.useState)(""),[Q,Y]=(0,n.useState)({}),[ee,et]=(0,n.useState)(!1),es=(0,n.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];s&&e&&s(!0),e&&F(!0),et(!1);try{let t=await g.ZP.get(x.R),r=(t||[]).map(e=>({...e,usernameDisplay:K(e.username,e.userId),fullEmailID:G(e.username,e.userId),clusterCount:-1,jobCount:-1,gpuCount:-1}));Z(r),O(!0),s&&e&&s(!1),e&&F(!1);let n=[],a={jobs:[]};try{[n,a]=await Promise.all([g.ZP.get(h.getClusters),g.ZP.get(p.getManagedJobs,[{allUsers:!0,skipFinished:!0}])])}catch(e){console.error("Error fetching clusters and managed jobs:",e)}let l=a.jobs||[],o={},i=e=>{if(!e)return null;let t=e;if("string"==typeof e)try{let s=e.replace(/'/g,'"').replace(/None/g,"null");t=JSON.parse(s)}catch(e){return null}if("object"==typeof t&&null!==t){let e=Object.entries(t);if(e.length>0)return e[0][0]}return null},c=(e,t,s,r,n,a)=>{e&&t&&(o[e]||(o[e]={}),o[e][t]||(o[e][t]={}),o[e].Total||(o[e].Total={}),o[e][t].Total||(o[e][t].Total={clusterCount:0,jobCount:0,gpuCount:0}),o[e][t].Total.clusterCount+=r,o[e][t].Total.jobCount+=n,o[e][t].Total.gpuCount+=a,s&&(o[e][t][s]||(o[e][t][s]={clusterCount:0,jobCount:0,gpuCount:0}),o[e][t][s].clusterCount+=r,o[e][t][s].jobCount+=n,o[e][t][s].gpuCount+=a,o[e].Total[s]||(o[e].Total[s]={clusterCount:0,jobCount:0,gpuCount:0}),o[e].Total[s].clusterCount+=r,o[e].Total[s].jobCount+=n,o[e].Total[s].gpuCount+=a))};for(let e of n||[]){let t=e.user_hash;if(!t)continue;let s=i(e.gpus),r=e.infra,n=0;if("STOPPED"!==e.status&&"TERMINATED"!==e.status){let t=B(e.gpus,"Cluster ".concat(e.cluster)),s=e.num_nodes||1;n=t*s}c(t,r,s,1,0,n)}let u=e=>{if(!e||"string"!=typeof e)return 1;let t=e.match(/^(\d+)x/);return t?parseInt(t[1],10):1};for(let e of l||[]){if(!V.has(e.status))continue;let t=e.user_hash;if(!t)continue;let s=i(e.accelerators),r=e.infra,n=B(e.accelerators,"Job ".concat(e.job_id)),a=u(e.resources_str_full),l=n*a;c(t,r,s,0,1,l)}Y(o),et(!0);let d=(t||[]).map(e=>{let t=0,s=0,r=0,a=0;for(let r of n||[])if(r.user_hash===e.userId&&(t++,"STOPPED"!==r.status&&"TERMINATED"!==r.status)){let e=B(r.gpus,"Cluster ".concat(r.cluster)),t=r.num_nodes||1;s+=e*t}for(let t of l||[])if(t.user_hash===e.userId&&V.has(t.status)){r++;let e=B(t.accelerators,"Job ".concat(t.job_id)),s=u(t.resources_str_full);a+=e*s}return{...e,usernameDisplay:K(e.username,e.userId),fullEmailID:G(e.username,e.userId),clusterCount:t,jobCount:r,gpuCount:s+a}}),m=new Set,f=new Set;for(let e of Object.values(o)){for(let t of Object.keys(e))"Total"!==t&&m.add(t);if(e.Total)for(let t of Object.keys(e.Total))f.add(t)}let b=new Set,j=new Set,y=new Set;d.forEach(e=>{e.usernameDisplay&&b.add(e.usernameDisplay),e.userId&&j.add(e.userId),e.role&&y.add(e.role)}),C({name:Array.from(b).sort(),"user id":Array.from(j).sort(),role:Array.from(y).sort(),"gpu type":Array.from(f).sort(),infra:Array.from(m).sort()}),Z(d)}catch(t){console.error("Failed to fetch or process user data:",t),Z([]),O(!0),s&&e&&s(!1),e&&F(!1)}finally{S&&S(new Date)}},[s,S]);(0,n.useEffect)(()=>{a&&(a.current=()=>es(!0))},[a,es]),(0,n.useEffect)(()=>{(async()=>{O(!1),F(!0),await f.ZP.preloadForPage("users"),es(!0)})();let e=setInterval(()=>{"visible"===window.document.visibilityState&&es(!1)},t);return()=>clearInterval(e)},[es,t]);let er=(0,n.useMemo)(()=>{let e=L,t=k.filter(e=>"GPU"!==e.property&&"Infra"!==e.property),s=k.filter(e=>"GPU"===e.property),r=k.filter(e=>"Infra"===e.property);t.length>0&&(e=(0,z.cm)(L.map(e=>({...e,name:e.usernameDisplay,"user id":e.userId})),t));let n=(e,t,s)=>{let r=0,n=0,a=0,l=Q[e];if(!l)return{clusterCount:0,jobCount:0,gpuCount:0};let o=t.map(e=>e.toLowerCase()),i=s.map(e=>e.toLowerCase()),c=o.length>0,u=i.length>0;if(c&&u){for(let e of i)for(let[t,s]of Object.entries(l))if("Total"!==t&&t.toLowerCase()===e)for(let e of o)for(let[t,l]of Object.entries(s))"Total"!==t&&t.toLowerCase()===e&&(r+=l.clusterCount,n+=l.jobCount,a+=l.gpuCount)}else if(u){for(let e of i)for(let[t,s]of Object.entries(l))if("Total"!==t&&t.toLowerCase()===e&&s.Total){let e=s.Total;r+=e.clusterCount,n+=e.jobCount,a+=e.gpuCount}}else if(c&&l.Total)for(let e of o)for(let[t,s]of Object.entries(l.Total))t.toLowerCase()===e&&(r+=s.clusterCount,n+=s.jobCount,a+=s.gpuCount);return{clusterCount:r,jobCount:n,gpuCount:a}},a=s.length>0,l=r.length>0;if(a||l){let t=s.map(e=>e.value).filter(Boolean),o=r.map(e=>e.value).filter(Boolean),i=t.map(e=>e.toLowerCase()),c=o.map(e=>e.toLowerCase());e=(e=e.filter(e=>{let t=Q[e.userId];if(!t)return!1;if(a&&l){for(let e of c)for(let[s,r]of Object.entries(t))if("Total"!==s&&s.toLowerCase()===e){for(let e of i)for(let t of Object.keys(r))if("Total"!==t&&t.toLowerCase()===e)return!0}}else if(l){for(let e of c)for(let s of Object.keys(t))if("Total"!==s&&s.toLowerCase()===e)return!0}else if(a&&t.Total){for(let e of i)for(let s of Object.keys(t.Total))if(s.toLowerCase()===e)return!0}return!1})).map(e=>{let s=n(e.userId,t,o);return{...e,clusterCount:s.clusterCount,jobCount:s.jobCount,gpuCount:s.gpuCount}})}if(_){let t={};e.forEach(e=>{let s=e.usernameDisplay;t[s]?(t[s].userIds.push(e.userId),-1!==e.clusterCount&&(-1===t[s].clusterCount?t[s].clusterCount=e.clusterCount:t[s].clusterCount+=e.clusterCount),-1!==e.jobCount&&(-1===t[s].jobCount?t[s].jobCount=e.jobCount:t[s].jobCount+=e.jobCount),-1!==e.gpuCount&&(-1===t[s].gpuCount?t[s].gpuCount=e.gpuCount:t[s].gpuCount+=e.gpuCount),e.created_at&&(!t[s].created_at||e.created_at<t[s].created_at)&&(t[s].created_at=e.created_at)):t[s]={...e,userIds:[e.userId],clusterCount:e.clusterCount,jobCount:e.jobCount,gpuCount:e.gpuCount,created_at:e.created_at}}),e=Object.values(t)}return(0,j.R0)(e,q.key,q.direction)},[L,q,k,_,Q]),en=e=>{let t="ascending";q.key===e&&"ascending"===q.direction&&(t="descending"),J({key:e,direction:t})},ea=e=>q.key===e?"ascending"===q.direction?" ↑":" ↓":"",el=async(e,t)=>{await l("cannot edit user role",()=>{H(e),X(t)})},eo=()=>{H(null),X("")},ei=async e=>{if(!e||!W){console.error("User ID or role is missing."),alert("Error: User ID or role is missing.");return}F(!0);try{let t=await A.x.post("/users/update",{user_id:e,role:W});if(!t.ok){let e=await t.json();throw Error(e.detail||"Failed to update role")}g.ZP.invalidate(x.R),await es(!0),eo()}catch(e){console.error("Failed to update user role:",e),alert("Error updating role: ".concat(e.message))}finally{F(!1)}};return P&&0===L.length&&!M?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)(o.Z,{})}):M?k.some(e=>"GPU"===e.property||"Infra"===e.property)&&!ee?(0,r.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,r.jsx)(o.Z,{}),(0,r.jsx)("span",{className:"ml-2 text-gray-500",children:"Loading filtered data..."})]}):er&&0!==er.length?(0,r.jsx)(U.Zb,{children:(0,r.jsx)("div",{className:"overflow-x-auto rounded-lg",children:(0,r.jsxs)(m.iA,{className:"min-w-full",children:[(0,r.jsx)(m.xD,{children:(0,r.jsxs)(m.SC,{children:[(0,r.jsxs)(m.ss,{onClick:()=>en("usernameDisplay"),className:"sortable whitespace-nowrap cursor-pointer hover:bg-gray-50 w-1/6",children:["Name",ea("usernameDisplay")]}),!_&&(0,r.jsxs)(m.ss,{onClick:()=>en("fullEmailID"),className:"sortable whitespace-nowrap cursor-pointer hover:bg-gray-50 w-1/6",children:["User ID",ea("fullEmailID")]}),!_&&!v&&(0,r.jsxs)(m.ss,{onClick:()=>en("role"),className:"sortable whitespace-nowrap cursor-pointer hover:bg-gray-50 w-1/6",children:["Role",ea("role")]}),(0,r.jsxs)(m.ss,{onClick:()=>en("created_at"),className:"sortable whitespace-nowrap cursor-pointer hover:bg-gray-50 w-1/6",children:["Joined",ea("created_at")]}),(0,r.jsxs)(m.ss,{onClick:()=>en("gpuCount"),className:"sortable whitespace-nowrap cursor-pointer hover:bg-gray-50 w-1/6",children:["GPUs",ea("gpuCount")]}),(0,r.jsxs)(m.ss,{onClick:()=>en("clusterCount"),className:"sortable whitespace-nowrap cursor-pointer hover:bg-gray-50 w-1/6",children:["Clusters",ea("clusterCount")]}),(0,r.jsxs)(m.ss,{onClick:()=>en("jobCount"),className:"sortable whitespace-nowrap cursor-pointer hover:bg-gray-50 w-1/6",children:["Jobs",ea("jobCount")]}),!_&&(b||"admin"===w)&&(0,r.jsx)(m.ss,{className:"whitespace-nowrap w-1/7",children:"Actions"})]})}),(0,r.jsx)(m.RM,{children:er.map(e=>(0,r.jsxs)(m.SC,{children:[(0,r.jsx)(m.pj,{className:"truncate",title:e.username,children:e.usernameDisplay}),!_&&(0,r.jsx)(m.pj,{className:"truncate",title:e.fullEmailID,children:e.fullEmailID}),!_&&!v&&(0,r.jsx)(m.pj,{className:"truncate",title:e.role,children:(0,r.jsx)("div",{className:"flex items-center gap-2",children:$===e.userId?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("select",{value:W,onChange:e=>X(e.target.value),className:"block w-auto p-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-sky-blue focus:border-sky-blue sm:text-sm",children:[(0,r.jsx)("option",{value:"admin",children:"Admin"}),(0,r.jsx)("option",{value:"user",children:"User"})]}),(0,r.jsx)("button",{onClick:()=>ei(e.userId),className:"text-green-600 hover:text-green-800 p-1",title:"Save",children:(0,r.jsx)(E.Z,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:eo,className:"text-gray-500 hover:text-gray-700 p-1",title:"Cancel",children:(0,r.jsx)(R.Z,{className:"h-4 w-4"})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"capitalize",children:e.role}),"admin"===w&&(0,r.jsx)("button",{onClick:()=>el(e.userId,e.role),className:"text-blue-600 hover:text-blue-700 p-1",title:"Edit role",children:(0,r.jsx)(D,{className:"h-3 w-3"})})]})})}),(0,r.jsx)(m.pj,{className:"truncate",children:e.created_at?(0,r.jsx)(y.Zg,{date:new Date(1e3*e.created_at)}):"-"}),(0,r.jsx)(m.pj,{children:-1===e.gpuCount?(0,r.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-500 rounded text-xs font-medium",children:(0,r.jsx)(o.Z,{size:12})}):(0,r.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium ".concat(e.gpuCount>0?"bg-purple-100 text-purple-600":"bg-gray-100 text-gray-500"),title:"Total GPUs: ".concat(e.gpuCount),children:e.gpuCount})}),(0,r.jsx)(m.pj,{children:-1===e.clusterCount?(0,r.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-500 rounded text-xs font-medium",children:(0,r.jsx)(o.Z,{size:12})}):(0,r.jsx)(c(),{href:"/clusters?property=user&operator=%3A&value=".concat(encodeURIComponent(e.username)),className:"px-2 py-0.5 rounded text-xs font-medium transition-colors duration-200 cursor-pointer inline-block ".concat(e.clusterCount>0?"bg-blue-100 text-blue-600 hover:bg-blue-200 hover:text-blue-700":"bg-gray-100 text-gray-500 hover:bg-gray-200 hover:text-gray-700"),title:"View ".concat(e.clusterCount," cluster").concat(1!==e.clusterCount?"s":""," for ").concat(e.usernameDisplay),children:e.clusterCount})}),(0,r.jsx)(m.pj,{children:-1===e.jobCount?(0,r.jsx)("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-500 rounded text-xs font-medium",children:(0,r.jsx)(o.Z,{size:12})}):(0,r.jsx)(c(),{href:"/jobs?property=user&operator=%3A&value=".concat(encodeURIComponent(e.username)),className:"px-2 py-0.5 rounded text-xs font-medium transition-colors duration-200 cursor-pointer inline-block ".concat(e.jobCount>0?"bg-green-100 text-green-600 hover:bg-green-200 hover:text-green-700":"bg-gray-100 text-gray-500 hover:bg-gray-200 hover:text-gray-700"),title:"View ".concat(e.jobCount," active job").concat(1!==e.jobCount?"s":""," for ").concat(e.usernameDisplay),children:e.jobCount})}),!_&&(b||"admin"===w)&&(0,r.jsx)(m.pj,{className:"relative",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[b&&(0,r.jsx)("button",{onClick:"admin"===w||e.userId===N?async()=>{u(e)}:void 0,className:"admin"===w||e.userId===N?"text-blue-600 hover:text-blue-700 p-1":"text-gray-300 cursor-not-allowed p-1",title:"admin"===w||e.userId===N?"Reset Password":"You can only reset your own password",disabled:"admin"!==w&&e.userId!==N,children:(0,r.jsx)(I,{className:"h-4 w-4"})}),"admin"===w&&(0,r.jsx)("button",{onClick:()=>d(e),className:"text-red-600 hover:text-red-700 p-1",title:"Delete User",children:(0,r.jsx)(T.Z,{className:"h-4 w-4"})})]})})]},e.userId))})]})})}):(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("p",{className:"text-lg font-semibold text-gray-500",children:k.length>0?"No users match your filters.":"No users found."}),(0,r.jsx)("p",{className:"text-sm text-gray-400 mt-1",children:k.length>0?"Try adjusting your filter criteria.":"There are currently no users to display."})]}):(0,r.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,r.jsx)(o.Z,{}),(0,r.jsx)("span",{className:"ml-2 text-gray-500",children:"Loading users..."})]})}function X(e){var t;let{checkPermissionAndAct:s,userRoleCache:a,setCreateSuccess:l,setCreateError:i,showCreateDialog:u,setShowCreateDialog:d,showRotateDialog:f,setShowRotateDialog:b,tokenToRotate:j,setTokenToRotate:v,rotating:w,setRotating:k,searchQuery:C,setSearchQuery:_}=e,[S,Z]=(0,n.useState)([]),[P,M]=(0,n.useState)(!0),[O,z]=(0,n.useState)(!1),[q,K]=(0,n.useState)(null),[G,J]=(0,n.useState)(null),[$,H]=(0,n.useState)({token_name:"",expires_in_days:30}),[W,X]=(0,n.useState)(""),[Q,Y]=(0,n.useState)(!1),[ee,et]=(0,n.useState)(!1),[es,er]=(0,n.useState)(""),[en,ea]=(0,n.useState)(null),[el,eo]=(0,n.useState)(null),[ei,ec]=(0,n.useState)(null),[eu,ed]=(0,n.useState)(""),[em,ex]=(0,n.useState)([]),eh=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{M(!0),e&&g.ZP.invalidate(x.i);let t=await g.ZP.get(x.i);Z(t||[]);let s=[],r={jobs:[]};try{[s,r]=await Promise.all([g.ZP.get(h.getClusters),g.ZP.get(p.getManagedJobs,[{allUsers:!0,skipFinished:!0}])])}catch(e){console.error("Error fetching clusters and managed jobs:",e)}let n=s||[],a=(null==r?void 0:r.jobs)||[],l=(t||[]).map(e=>{let t=e.service_account_user_id,s=0,r=0,l=0,o=0;for(let e of n)e.user_hash===t&&(s++,"STOPPED"!==e.status&&"TERMINATED"!==e.status&&(r+=B(e.gpus,"Cluster ".concat(e.cluster))));for(let e of a)e.user_hash===t&&V.has(e.status)&&(l++,o+=B(e.accelerators,"Job ".concat(e.job_name||e.job_id)));return{...e,clusterCount:s,jobCount:l,gpuCount:r+o,primaryRole:e.service_account_roles&&e.service_account_roles.length>0?e.service_account_roles[0]:"user"}});ex(l)}catch(e){console.error("Error fetching tokens and counts:",e),Z([]),ex([])}finally{M(!1)}};(0,n.useEffect)(()=>{eh()},[]);let ep=async(e,t)=>{await s("cannot edit service account role",()=>{ec(e),ed(t)})},eg=()=>{ec(null),ed("")},ef=async e=>{if(!e||!eu){console.error("Token ID or role is missing."),i(Error("Token ID or role is missing."));return}M(!0);try{let t=await A.x.post("/users/service-account-tokens/update-role",{token_id:e,role:eu});if(!t.ok){let e=await t.json();throw Error(e.detail||"Failed to update role")}l("Service account role updated successfully!"),await eh(!0),eg()}catch(e){console.error("Failed to update service account role:",e),i(e)}finally{M(!1)}},eb=async e=>{try{await navigator.clipboard.writeText(e),er("Copied!"),setTimeout(()=>er(""),2e3)}catch(e){console.error("Failed to copy:",e)}},ej=async()=>{if(!$.token_name.trim()){i(Error("Token name is required"));return}Y(!0);try{let e={token_name:$.token_name.trim(),expires_in_days:""===$.expires_in_days?null:$.expires_in_days},t=await A.x.post("/users/service-account-tokens",e);if(t.ok){let e=await t.json();ea(e.token),H({token_name:"",expires_in_days:30}),await eh(!0)}else{let e=await t.json();throw Error(e.detail||"Failed to create token")}}catch(e){i(e)}finally{Y(!1)}},ey=async()=>{if(q){et(!0),J(null);try{let e=await A.x.post("/users/service-account-tokens/delete",{token_id:q.token_id});if(e.ok)l('Service account "'.concat(q.token_name,'" deleted successfully!')),z(!1),K(null),J(null),await eh(!0);else{let t=await e.json();throw Error(t.detail||"Failed to delete service account")}}catch(e){z(!1),K(null),J(null),i(e)}finally{et(!1)}}},ev=async()=>{if(j){k(!0);try{let e={token_id:j.token_id,expires_in_days:""===W?null:parseInt(W)},t=await A.x.post("/users/service-account-tokens/rotate",e);if(t.ok){let e=await t.json();eo(e.token),await eh(!0)}else{let e=await t.json();throw Error(e.detail||"Failed to rotate token")}}catch(e){i(e)}finally{k(!1)}}},ew=em.filter(e=>{var t,s,r,n;if(!(null==C?void 0:C.trim()))return!0;let a=C.toLowerCase();return(null===(t=e.token_name)||void 0===t?void 0:t.toLowerCase().includes(a))||(null===(s=e.creator_name)||void 0===s?void 0:s.toLowerCase().includes(a))||(null===(r=e.service_account_name)||void 0===r?void 0:r.toLowerCase().includes(a))||(null===(n=e.primaryRole)||void 0===n?void 0:n.toLowerCase().includes(a))});return P&&0===em.length?(0,r.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,r.jsx)(o.Z,{size:32}),(0,r.jsx)("span",{className:"ml-3",children:"Loading tokens..."})]}):(0,r.jsxs)(r.Fragment,{children:[0===ew.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)(I,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:(null==C?void 0:C.trim())?"No tokens match your search":"No service accounts"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:(null==C?void 0:C.trim())?"Try adjusting your search terms.":"No service accounts have been created yet."})]}):(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(U.Zb,{children:(0,r.jsxs)(m.iA,{children:[(0,r.jsx)(m.xD,{children:(0,r.jsxs)(m.SC,{children:[(0,r.jsx)(m.ss,{children:"Name"}),(0,r.jsx)(m.ss,{children:"Created by"}),(0,r.jsx)(m.ss,{children:"Role"}),(0,r.jsx)(m.ss,{children:"Clusters"}),(0,r.jsx)(m.ss,{children:"Jobs"}),(0,r.jsx)(m.ss,{children:"GPUs"}),(0,r.jsx)(m.ss,{children:"Created"}),(0,r.jsx)(m.ss,{children:"Last used"}),(0,r.jsx)(m.ss,{children:"Expires"}),(0,r.jsx)(m.ss,{children:"Actions"})]})}),(0,r.jsx)(m.RM,{children:ew.map(e=>(0,r.jsxs)(m.SC,{children:[(0,r.jsx)(m.pj,{className:"truncate",title:e.token_name,children:e.token_name}),(0,r.jsx)(m.pj,{className:"truncate",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{children:e.creator_name||"Unknown"}),e.creator_user_hash!==(null==a?void 0:a.id)&&(0,r.jsx)("span",{className:"ml-2 px-1.5 py-0.5 text-xs bg-gray-100 text-gray-600 rounded",children:"Other"})]})}),(0,r.jsx)(m.pj,{className:"truncate",children:(0,r.jsx)("div",{className:"flex items-center gap-2",children:ei===e.token_id?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("select",{value:eu,onChange:e=>ed(e.target.value),className:"block w-auto p-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-sky-blue focus:border-sky-blue sm:text-sm",children:[(0,r.jsx)("option",{value:"admin",children:"Admin"}),(0,r.jsx)("option",{value:"user",children:"User"})]}),(0,r.jsx)("button",{onClick:()=>ef(e.token_id),className:"text-green-600 hover:text-green-800 p-1",title:"Save",children:(0,r.jsx)(E.Z,{className:"h-4 w-4"})}),(0,r.jsx)("button",{onClick:eg,className:"text-gray-500 hover:text-gray-700 p-1",title:"Cancel",children:(0,r.jsx)(R.Z,{className:"h-4 w-4"})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"capitalize",children:e.primaryRole}),((null==a?void 0:a.role)==="admin"||e.creator_user_hash===(null==a?void 0:a.id))&&(0,r.jsx)("button",{onClick:()=>ep(e.token_id,e.primaryRole),className:"text-blue-600 hover:text-blue-700 p-1",title:"Edit role",children:(0,r.jsx)(D,{className:"h-3 w-3"})})]})})}),(0,r.jsx)(m.pj,{children:(0,r.jsx)(c(),{href:"/clusters?property=user&operator=%3A&value=".concat(encodeURIComponent(e.service_account_name)),className:"px-2 py-0.5 rounded text-xs font-medium transition-colors duration-200 cursor-pointer inline-block ".concat(e.clusterCount>0?"bg-blue-100 text-blue-600 hover:bg-blue-200 hover:text-blue-700":"bg-gray-100 text-gray-500 hover:bg-gray-200 hover:text-gray-700"),title:"View ".concat(e.clusterCount," cluster").concat(1!==e.clusterCount?"s":""," for ").concat(e.token_name),children:e.clusterCount})}),(0,r.jsx)(m.pj,{children:(0,r.jsx)(c(),{href:"/jobs?property=user&operator=%3A&value=".concat(encodeURIComponent(e.service_account_name)),className:"px-2 py-0.5 rounded text-xs font-medium transition-colors duration-200 cursor-pointer inline-block ".concat(e.jobCount>0?"bg-green-100 text-green-600 hover:bg-green-200 hover:text-green-700":"bg-gray-100 text-gray-500 hover:bg-gray-200 hover:text-gray-700"),title:"View ".concat(e.jobCount," active job").concat(1!==e.jobCount?"s":""," for ").concat(e.token_name),children:e.jobCount})}),(0,r.jsx)(m.pj,{children:(0,r.jsx)("span",{className:"px-2 py-0.5 rounded text-xs font-medium ".concat(e.gpuCount>0?"bg-purple-100 text-purple-600":"bg-gray-100 text-gray-500"),title:"Total GPUs: ".concat(e.gpuCount),children:e.gpuCount})}),(0,r.jsx)(m.pj,{className:"truncate",children:e.created_at?(0,r.jsx)(y.Zg,{date:new Date(1e3*e.created_at)}):"Never"}),(0,r.jsx)(m.pj,{className:"truncate",children:e.last_used_at?(0,r.jsx)(y.Zg,{date:new Date(1e3*e.last_used_at)}):"Never"}),(0,r.jsx)(m.pj,{className:"truncate",children:e.expires_at?new Date(1e3*e.expires_at)<new Date?(0,r.jsx)("span",{className:"text-red-600",children:"Expired"}):(0,r.jsx)(y.Zg,{date:new Date(1e3*e.expires_at)}):"Never"}),(0,r.jsx)(m.pj,{children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[((null==a?void 0:a.role)==="admin"||e.creator_user_hash===(null==a?void 0:a.id))&&(0,r.jsx)(y.WH,{content:"Rotate token",className:"capitalize text-sm text-muted-foreground",children:(0,r.jsx)("button",{onClick:()=>{s("cannot rotate service account tokens",()=>{v(e),b(!0)})},className:"text-sky-blue hover:text-sky-blue-bright font-medium inline-flex items-center",children:(0,r.jsx)(N.Z,{className:"h-4 w-4"})})}),((null==a?void 0:a.role)==="admin"||e.creator_user_hash===(null==a?void 0:a.id))&&(0,r.jsx)(y.WH,{content:"Delete ".concat(e.token_name),className:"capitalize text-sm text-muted-foreground",children:(0,r.jsx)("button",{onClick:()=>{s("cannot delete service account tokens",()=>{K(e),z(!0)})},className:"text-red-600 hover:text-red-800 font-medium inline-flex items-center",children:(0,r.jsx)(T.Z,{className:"h-4 w-4"})})})]})})]},e.token_id))})]})})}),(0,r.jsx)(F.Vq,{open:u,onOpenChange:e=>{d(e),e||(ea(null),i(null))},children:(0,r.jsxs)(F.cZ,{className:"sm:max-w-2xl",children:[(0,r.jsxs)(F.fK,{children:[(0,r.jsx)(F.$N,{children:"Create Service Account"}),(0,r.jsx)(F.Be,{children:"Create a new service account with an API token for programmatic access to SkyPilot."})]}),(0,r.jsx)("div",{className:"flex flex-col gap-4 py-4",children:en?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center mb-3",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-green-900",children:"⚠️ Service account created successfully - save this token now!"}),(0,r.jsx)(y.WH,{content:es?"Copied!":"Copy token",className:"text-muted-foreground",children:(0,r.jsx)("button",{onClick:()=>eb(en),className:"flex items-center text-green-600 hover:text-green-800 transition-colors duration-200 p-1 ml-2",children:es?(0,r.jsx)(E.Z,{className:"w-4 h-4"}):(0,r.jsx)(L.Z,{className:"w-4 h-4"})})})]}),(0,r.jsx)("p",{className:"text-sm text-green-700 mb-3",children:"This service account token will not be shown again. Please copy and store it securely."}),(0,r.jsx)("div",{className:"bg-white border border-green-300 rounded-md p-3",children:(0,r.jsx)("code",{className:"text-sm text-gray-800 font-mono break-all block",children:en})})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Service Account Name"}),(0,r.jsx)("input",{className:"border rounded px-3 py-2 w-full",placeholder:"e.g., ci-pipeline, monitoring-system",value:$.token_name,onChange:e=>H({...$,token_name:e.target.value})})]}),(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Expiration (days)"}),(0,r.jsx)("input",{type:"number",className:"border rounded px-3 py-2 w-full",placeholder:"e.g., 30",min:"0",max:"365",value:null!==(t=$.expires_in_days)&&void 0!==t?t:"",onChange:e=>H({...$,expires_in_days:e.target.value?parseInt(e.target.value):null})}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Leave empty or enter 0 to never expire. Maximum 365 days."})]})]})}),(0,r.jsx)(F.cN,{children:en?(0,r.jsx)("button",{className:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-sky-600 text-white hover:bg-sky-700 h-10 px-4 py-2",onClick:()=>{d(!1),ea(null)},children:"Close"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{className:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2",onClick:()=>{d(!1),ea(null)},disabled:Q,children:"Cancel"}),(0,r.jsx)("button",{className:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-sky-600 text-white hover:bg-sky-700 h-10 px-4 py-2",onClick:ej,disabled:Q||!$.token_name.trim(),children:Q?"Creating...":"Create Token"})]})})]})}),(0,r.jsx)(F.Vq,{open:O,onOpenChange:e=>{z(e),e||(K(null),i(null))},children:(0,r.jsxs)(F.cZ,{className:"sm:max-w-md",children:[(0,r.jsxs)(F.fK,{children:[(0,r.jsx)(F.$N,{children:"Delete Service Account Token"}),(0,r.jsxs)(F.Be,{children:['Are you sure you want to delete the service account "',null==q?void 0:q.token_name,'"',(null==q?void 0:q.creator_user_hash)!==(null==a?void 0:a.id)&&(null==a?void 0:a.role)==="admin"?" owned by ".concat(null==q?void 0:q.creator_name):"","? This action cannot be undone and will immediately revoke access for any systems using this token."]})]}),(0,r.jsxs)(F.cN,{children:[(0,r.jsx)("button",{className:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2",onClick:()=>{z(!1),K(null)},disabled:ee,children:"Cancel"}),(0,r.jsx)("button",{className:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-red-600 text-white hover:bg-red-700 h-10 px-4 py-2",onClick:ey,disabled:ee,children:ee?"Deleting...":"Delete Token"})]})]})}),(0,r.jsx)(F.Vq,{open:f,onOpenChange:e=>{b(e),e||(v(null),X(""),eo(null),i(null))},children:(0,r.jsxs)(F.cZ,{className:"sm:max-w-2xl",children:[(0,r.jsxs)(F.fK,{children:[(0,r.jsx)(F.$N,{children:"Rotate Service Account Token"}),(0,r.jsxs)(F.Be,{children:['Rotate the service account token "',null==j?void 0:j.token_name,'"',(null==j?void 0:j.creator_user_hash)!==(null==a?void 0:a.id)&&(null==a?void 0:a.role)==="admin"?" owned by ".concat(null==j?void 0:j.creator_name):"",". This will generate a new token value and invalidate the current one."]})]}),(0,r.jsx)("div",{className:"flex flex-col gap-4 py-4",children:el?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,r.jsxs)("div",{className:"flex items-center mb-3",children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-green-900",children:"\uD83D\uDD04 Service account token rotated successfully - save this new token now!"}),(0,r.jsx)(y.WH,{content:es?"Copied!":"Copy token",className:"text-muted-foreground",children:(0,r.jsx)("button",{onClick:()=>eb(el),className:"flex items-center text-green-600 hover:text-green-800 transition-colors duration-200 p-1 ml-2",children:es?(0,r.jsx)(E.Z,{className:"w-4 h-4"}):(0,r.jsx)(L.Z,{className:"w-4 h-4"})})})]}),(0,r.jsx)("p",{className:"text-sm text-green-700 mb-3",children:"This new token replaces the old one. Please copy and store it securely. The old token is now invalid."}),(0,r.jsx)("div",{className:"bg-white border border-green-300 rounded-md p-3",children:(0,r.jsx)("code",{className:"text-sm text-gray-800 font-mono break-all block",children:el})})]})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"grid gap-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"New Expiration (days)"}),(0,r.jsx)("input",{type:"number",className:"border rounded px-3 py-2 w-full",placeholder:"Leave empty to preserve current expiration",min:"0",max:"365",value:W,onChange:e=>X(e.target.value)}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"Leave empty to preserve current expiration. Enter number of days for new expiration, or enter 0 to set to never expire. Maximum 365 days."})]}),(0,r.jsx)("div",{className:"p-3 bg-amber-50 border border-amber-200 rounded",children:(0,r.jsx)("p",{className:"text-sm text-amber-700",children:"⚠️ Any systems using the current token will need to be updated with the new token."})})]})}),(0,r.jsx)(F.cN,{children:el?(0,r.jsx)("button",{className:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-green-600 text-white hover:bg-green-700 h-10 px-4 py-2",onClick:()=>{b(!1),v(null),X(""),eo(null)},children:"Close"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{className:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2",onClick:()=>{b(!1),v(null),X(""),eo(null)},disabled:w,children:"Cancel"}),(0,r.jsx)("button",{className:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-sky-600 text-white hover:bg-sky-700 h-10 px-4 py-2",onClick:ev,disabled:w,children:w?"Rotating...":"Rotate Token"})]})})]})})]})}W.propTypes={refreshInterval:l().number.isRequired,setLoading:l().func.isRequired,refreshDataRef:l().shape({current:l().func}).isRequired,checkPermissionAndAct:l().func.isRequired,roleLoading:l().bool.isRequired,onResetPassword:l().func.isRequired,onDeleteUser:l().func.isRequired,basicAuthEnabled:l().bool,ingressBasicAuthEnabled:l().bool,currentUserRole:l().string,currentUserId:l().string,setLastFetchedTime:l().func}},12003:function(e,t,s){s.d(t,{j:function(){return l}});var r=s(90512);let n=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,a=r.W,l=(e,t)=>s=>{var r;if((null==t?void 0:t.variants)==null)return a(e,null==s?void 0:s.class,null==s?void 0:s.className);let{variants:l,defaultVariants:o}=t,i=Object.keys(l).map(e=>{let t=null==s?void 0:s[e],r=null==o?void 0:o[e];if(null===t)return null;let a=n(t)||n(r);return l[e][a]}),c=s&&Object.entries(s).reduce((e,t)=>{let[s,r]=t;return void 0===r||(e[s]=r),e},{});return a(e,i,null==t?void 0:null===(r=t.compoundVariants)||void 0===r?void 0:r.reduce((e,t)=>{let{class:s,className:r,...n}=t;return Object.entries(n).every(e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...o,...c}[t]):({...o,...c})[t]===s})?[...e,s,r]:e},[]),null==s?void 0:s.class,null==s?void 0:s.className)}}}]);