service:
  readiness_probe:
    path: /
    initial_delay_seconds: 60
  replicas: 1

resources:
  accelerators: RTX4060-SHARED:1
  ports: 8080

setup: |
  pip install fastapi uvicorn torch

run: |
  cat <<EOF > app.py
  from fastapi import FastAPI
  import torch
  
  app = FastAPI()
  
  @app.get("/")
  def root():
      return {"message": "Hello from SkyPilot on RTX 4060!"}
      
  @app.get("/gpu")
  def gpu_info():
      if torch.cuda.is_available():
          return {"gpu": torch.cuda.get_device_name(0)}
      return {"gpu": "not available"}
  EOF
  
  uvicorn app:app --host 0.0.0.0 --port 8080
